var m="Missing separator option.",x="Your JSON must be an array or an object.",o="Item in array is not an object: {0}";function S(n,f){f||(f=[]);function A(s,h){var v=s.slice(0);if(!Array.isArray(h))return v;for(var b=0;b<h.length;b++)v.indexOf(h[b])===-1&&v.push(h[b]);return v}function y(s,h){s=s||{};for(var v in h)typeof h[v]=="object"?s[v]=y(s[v],h[v]):s[v]=h[v];return s}for(var u=[],g=0;g<n.length;g++){var e=n[g],i={},t={},p=1;if(e!=null&&(!O(e)||Array.isArray(e)))throw o.replace("{0}",JSON.stringify(e));for(var a=N(e),r=0;r<a.length;r++){var l=e[a[r]],_=A(f,[a[r]]),c=_.join(".");Array.isArray(l)?(t[c]=S(l,_),p+=t[c].length):i[c]=l}if(p==1)u.push(i);else for(var a=N(t),r=0;r<a.length;r++)for(var c=a[r],j=0;j<t[c].length;j++)u.push(y(y({},i),t[c][j]))}return u}function O(n){return n&&typeof n=="object"}function N(n){return O(n)?Object.keys(n):[]}function J(n,f){if(f||(f={}),!O(n))throw x;Array.isArray(n)||(n=[n]);var A=f.separator||",";if(!A)throw m;var y=f.flatten||!1;y&&(n=S(n));for(var u=[],g=[],e=0;e<n.length;e++){var i=n[e],t={};if(i!=null&&(!O(i)||Array.isArray(i)))throw o.replace("{0}",JSON.stringify(i));for(var p=N(i),a=0;a<p.length;a++){var r=p[a];u.indexOf(r)===-1&&u.push(r);var l=i[r];l===void 0&&l===null||(typeof l=="string"?(t[r]='"'+l.replace(/"/g,f.output_csvjson_variant?'\\"':'""')+'"',f.output_csvjson_variant&&(t[r]=t[r].replace(/\n/g,"\\n"))):(t[r]=JSON.stringify(l),!f.output_csvjson_variant&&(O(l)||Array.isArray(l))&&(t[r]='"'+t[r].replace(/"/g,'\\"').replace(/\n/g,"\\n")+'"')))}g.push(t)}const _=[];for(var e=0;e<u.length;e++)_.push('"'+u[e].replace(/"/g,f.output_csvjson_variant?'\\"':'""')+'"');for(var c=_.join(A)+`
`,j=0;j<g.length;j++){for(var t=g[j],s=[],a=0;a<u.length;a++){var r=u[a];s.push(t[r]||(f.output_csvjson_variant?"null":""))}c+=s.join(A)+(j<g.length-1?`
`:"")}return c}export{J as default};
//# sourceMappingURL=json2csv-BPkPuabW.js.map
