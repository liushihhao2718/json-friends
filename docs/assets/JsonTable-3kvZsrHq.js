import{g as $,M as ee}from"./splitpanes-BKeNMENc.js";import{l as J}from"./json5-8HslT92O.js";import{j as R}from"./json-pointer-DT_4Huoh.js";import{j as le}from"./jsonpath-DagGPREx.js";import{T as M}from"./vue-codemirror-CD2WqnzD.js";import{F as te,z as se}from"./@codemirror-CVWAm84L.js";import{d as ae,r as m,f as ne,w as T,P as y,N as o,J as r,o as h,M as l,a as e,b as s,Q as x,R as L,E as re,c as ie,n as oe}from"./@vue-Dlv4l5Lu.js";import{d as S,e as P,N as A,f as ue,g as ce,h as de,i as pe,j as F,k as B,l as me,m as N}from"./naive-ui-3SbRWkTP.js";import{a as ve}from"./@vicons-DZ9fbbcs.js";import"./@babel-BosuxZz1.js";import"./foreach-BOrx_fet.js";import"./codemirror-Cb2lqhbD.js";import"./@lezer-DAKsaJXH.js";import"./crelt-C8TCjufn.js";import"./style-mod-Bc2inJdb.js";import"./w3c-keyname-Vcq4gwWv.js";import"./vooks-B7TXbpRG.js";import"./evtd-CI_DDEu_.js";import"./treemate-HRdUPn5m.js";import"./seemly-B1UhY21x.js";import"./vueuc-DD5SYv2c.js";import"./@css-render-s7r-NF5N.js";import"./vdirs-DL8EOfHr.js";import"./@juggle-C8OzoCMD.js";import"./css-render-Ct37b3-v.js";import"./@emotion-WldOFDRm.js";import"./date-fns-x7VUUoCw.js";import"./lodash-es-CqLjCvqY.js";const he="data:image/svg+xml,%3csvg%20fill='none'%20height='24'%20viewBox='0%200%2024%2024'%20width='24'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20stroke='%23292d32'%20stroke-linecap='round'%20stroke-linejoin='round'%20stroke-width='1.5'%3e%3cpath%20d='m21.97%2015v-6c0-5-2-7-7-7h-6.00003c-5%200-7%202-7%207v6c0%205%202%207%207%207h6.00003c5%200%207-2%207-7z'/%3e%3cpath%20d='m7.96997%202v20'/%3e%3cpath%20d='m14.97%209.43994-2.56%202.55996%202.56%202.56'/%3e%3c/g%3e%3c/svg%3e",fe="data:image/svg+xml,%3csvg%20fill='none'%20height='24'%20viewBox='0%200%2024%2024'%20width='24'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20stroke='%23292d32'%20stroke-linecap='round'%20stroke-linejoin='round'%20stroke-width='1.5'%3e%3cpath%20d='m21.97%2015v-6c0-5-2-7-7-7h-6.00003c-5%200-7%202-7%207v6c0%205%202%207%207%207h6.00003c5%200%207-2%207-7z'/%3e%3cpath%20d='m14.97%202v20'/%3e%3cpath%20d='m7.96997%209.43994%202.56003%202.55996-2.56003%202.56'/%3e%3c/g%3e%3c/svg%3e",ge="data:image/svg+xml,%3csvg%20height='24'%20viewBox='0%200%2024%2024'%20width='24'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='m5%203h2v2h-2v5a2%202%200%200%201%20-2%202%202%202%200%200%201%202%202v5h2v2h-2c-1.07-.27-2-.9-2-2v-4a2%202%200%200%200%20-2-2h-1v-2h1a2%202%200%200%200%202-2v-4a2%202%200%200%201%202-2m14%200a2%202%200%200%201%202%202v4a2%202%200%200%200%202%202h1v2h-1a2%202%200%200%200%20-2%202v4a2%202%200%200%201%20-2%202h-2v-2h2v-5a2%202%200%200%201%202-2%202%202%200%200%201%20-2-2v-5h-2v-2zm-7%2012a1%201%200%200%201%201%201%201%201%200%200%201%20-1%201%201%201%200%200%201%20-1-1%201%201%200%200%201%201-1m-4%200a1%201%200%200%201%201%201%201%201%200%200%201%20-1%201%201%201%200%200%201%20-1-1%201%201%200%200%201%201-1m8%200a1%201%200%200%201%201%201%201%201%200%200%201%20-1%201%201%201%200%200%201%20-1-1%201%201%200%200%201%201-1z'/%3e%3c/svg%3e",ye=["src"],_e=["src"],Se=["src"],Ne={style:{display:"block",width:"calc(100% - 20px)",margin:"10px auto"}},je=e("p",null,[s("A JSON Pointer is a list of zero-to-many tokens, each prefixed by "),e("code",null,"/"),s(". Each token can be a string or a number. For example, given a JSON: ")],-1),we=e("div",{class:"fragment"},[e("div",{class:"line"},"{"),e("div",{class:"line"},' "foo" : ["bar", "baz"],'),e("div",{class:"line"},' "pi" : 3.1416'),e("div",{class:"line"},"}")],-1),be=e("p",null,"The following JSON Pointers resolve this JSON as:",-1),xe=e("ol",{type:"1"},[e("li",null,[e("code",null,'"/foo"'),s(" → "),e("code",null,'[ "bar", "baz" ]')]),e("li",null,[e("code",null,'"/foo/0"'),s(" → "),e("code",null,'"bar"')]),e("li",null,[e("code",null,'"/foo/1"'),s(" → "),e("code",null,'"baz"')]),e("li",null,[e("code",null,'"/pi"'),s(" → "),e("code",null,"3.1416")])],-1),ke=e("p",null,[s("Note that, an empty JSON Pointer "),e("code",null,'""'),s(" (zero token) resolves to the whole JSON.")],-1),Oe=e("a",{href:"https://rapidjson.org/md_doc_pointer.html"},"https://rapidjson.org/md_doc_pointer.html",-1),ze=e("pre",{style:{margin:"0"}},[e("code",{class:"lang-json"},[e("span",null,[s(`{
    `),e("span",{class:"hljs-attr"},'"Source"'),s(": "),e("span",{class:"hljs-string"},'"Server-01"'),s(`,
    `),e("span",{class:"hljs-attr"},'"Timestamp"'),s(": "),e("span",{class:"hljs-string"},'"2023-07-25T09:15:32.123Z"'),s(`,
    `),e("span",{class:"hljs-attr"},'"Log Level"'),s(": "),e("span",{class:"hljs-string"},'"INFO"'),s(`,
    `),e("span",{class:"hljs-attr"},'"Message"'),s(": "),e("span",{class:"hljs-string"},'"Application started successfully."'),s(`,
    `),e("span",{class:"hljs-attr"},'"Details"'),s(`: {
      `),e("span",{class:"hljs-attr"},'"Service"'),s(": "),e("span",{class:"hljs-string"},'"AuthService"'),s(`,
      `),e("span",{class:"hljs-attr"},'"Endpoint"'),s(": "),e("span",{class:"hljs-string"},'"/api/login"'),s(`,
      `),e("span",{class:"hljs-attr"},'"Response Code"'),s(": "),e("span",{class:"hljs-number"},"200"),s(`,
      `),e("span",{class:"hljs-attr"},'"Response Time"'),s(": "),e("span",{class:"hljs-number"},"54.21"),s(`,
      `),e("span",{class:"hljs-attr"},'"User"'),s(`: {
        `),e("span",{class:"hljs-attr"},'"User ID"'),s(": "),e("span",{class:"hljs-string"},'"user123"'),s(`,
        `),e("span",{class:"hljs-attr"},'"Username"'),s(": "),e("span",{class:"hljs-string"},'"kiana_anderson"'),s(`,
        `),e("span",{class:"hljs-attr"},'"IP Address"'),s(": "),e("span",{class:"hljs-string"},'"192.168.1.100"'),s(`
      }
    }
  }`)]),s(`
`)]),s(`
`)],-1),$e=e("p",null,"您可以使用 JSONPath 表示法來代表每個欄位，如下所示：",-1),Je=e("pre",{class:"has-inner-focus"},[e("code",{class:"lang-kusto","data-author-content":`"$.Source"                     // Source field
"$.Timestamp"                  // Timestamp field
"$['Log Level']"               // Log Level field
"$.Message"                    // Message field
"$.Details.Service"            // Service field
"$.Details.Endpoint"           // Endpoint field
"$.Details['Response Code']"   // Response Code field
"$.Details['Response Time']"   // Response Time field
"$.Details.User['User ID']"    // User ID field
"$.Details.User.Username"      // Username field
"$.Details.User['IP Address']" // IP Address field
`},[e("span",null,[e("span",{class:"hljs-string"},'"$.Source"'),s("                     "),e("span",{class:"hljs-comment"},"// Source field"),s(`
`),e("span",{class:"hljs-string"},'"$.Timestamp"'),s("                  "),e("span",{class:"hljs-comment"},"// Timestamp field"),s(`
`),e("span",{class:"hljs-string"},`"$['Log Level']"`),s("               "),e("span",{class:"hljs-comment"},"// Log Level field"),s(`
`),e("span",{class:"hljs-string"},'"$.Message"'),s("                    "),e("span",{class:"hljs-comment"},"// Message field"),s(`
`),e("span",{class:"hljs-string"},'"$.Details.Service"'),s("            "),e("span",{class:"hljs-comment"},"// Service field"),s(`
`),e("span",{class:"hljs-string"},'"$.Details.Endpoint"'),s("           "),e("span",{class:"hljs-comment"},"// Endpoint field"),s(`
`),e("span",{class:"hljs-string"},`"$.Details['Response Code']"`),s("   "),e("span",{class:"hljs-comment"},"// Response Code field"),s(`
`),e("span",{class:"hljs-string"},`"$.Details['Response Time']"`),s("   "),e("span",{class:"hljs-comment"},"// Response Time field"),s(`
`),e("span",{class:"hljs-string"},`"$.Details.User['User ID']"`),s("    "),e("span",{class:"hljs-comment"},"// User ID field"),s(`
`),e("span",{class:"hljs-string"},'"$.Details.User.Username"'),s("      "),e("span",{class:"hljs-comment"},"// Username field"),s(`
`),e("span",{class:"hljs-string"},`"$.Details.User['IP Address']"`),s(),e("span",{class:"hljs-comment"},"// IP Address field"),s(`
`)])])],-1),Pe=e("a",{class:"n-a",href:"https://learn.microsoft.com/zh-tw/azure/data-explorer/kusto/query/jsonpath"},"https://learn.microsoft.com/zh-tw/azure/data-explorer/kusto/query/jsonpath",-1),Ae={key:0,style:{"margin-top":"5px"}},Ue=e("label",null,"JSON",-1),ul=ae({__name:"JsonTable",setup(Ce){const E=[te(),se.lineWrapping],_=m(JSON.parse(localStorage.getItem("json2table_auto")||"false")),d=m(localStorage.getItem("input_str")||"");let f=m(null);const v=m(null),U=m(""),k=m(`// data.map( d => d.name )
return data;`),C=[{label:"JSON Pointer",value:"JSON Pointer"},{label:"JSON Path",value:"JSON Path"}],q=JSON.parse(localStorage.getItem("json_table_pannels")||JSON.stringify([{close:!1,size:30,default_size:30},{close:!0,size:35,default_size:35},{close:!1,size:35,default_size:35},{close:!1,size:30,default_size:30}])),u=m(q),g=m(C[0].value),p=m(""),K=()=>{if(g.value==="JSON Pointer"){const t=p.value=="/"?"":p.value;return v.value=V(t,f.value),v.value?(console.log("sub_value",v),Array.isArray(v.value)?[t+"/0"]:Object.keys(v.value).map(a=>t+"/"+a)):[]}return[]};ne(()=>{_.value&&D()}),T([_],async()=>{localStorage.setItem("json2table_auto",_.value.toString())}),T([d,k,_],async()=>{_.value&&D()});function W(){return screen.width<=760}function D(){if(u.value[1].close)U.value=JSON.stringify(J.parse(d.value));else try{const t=new Function("data",`${k.value}`)(J.parse(d.value));U.value=JSON.stringify(t)}catch(t){console.log(t)}}const j=m("");async function I(t){u.value[t].close=!u.value[t].close;const a=u.value[1].close?u.value.filter((i,c)=>c!=1).map(i=>i.close?0:i.default_size):u.value.map(i=>i.close?0:i.default_size);u.value[1].close?u.value.filter((i,c)=>c!=1).forEach((i,c)=>{i.size=n(c)}):u.value.forEach((i,c)=>{i.size=n(c)}),localStorage.setItem("json_table_pannels",JSON.stringify(u.value));function n(i){const c=a.reduce((H,Y)=>H+Y,0);return Math.round(a[i]/c*100)}}function Q(t){try{u.value[1].close?(f.value=J.parse(t),d.value=JSON.stringify(JSON.parse(d.value),null,4),localStorage.setItem("input_str",t),p.value=p.value+""):(f.value=J.parse(t),d.value=JSON.stringify(JSON.parse(d.value),null,4),localStorage.setItem("input_str",d.value))}catch{f.value=null;return}return w(z(f.value))}function O(t,a){t.stopPropagation(),g.value="JSON Pointer",v.value=V(a,f.value),p.value=a,console.log(a)}function w(t,a=""){if(t){if(t.type=="Array")return l(N,{"single-line":!1,size:"small","data-pointer":a},{default:()=>[l("thead",{onClick:n=>O(n,a)},[l("tr",null,[l("th",null,[s("Array")])])]),l("tbody",null,[t.value.map((n,i)=>l("tr",null,[l("td",null,[w(n,`${a}/${i}`)])]))])]});if(t.type=="sameArrayField")return l(N,{"single-line":!1,size:"small"},{default:()=>[l("thead",null,[l("tr",null,[t.value[0].type==="Object"?t.value[0].value.map(n=>l("th",null,[n.name])):l("th",null,[t.value[0].type])])]),l("tbody",null,[t.value.map((n,i)=>l("tr",null,[n.type==="Object"?n.value.map(c=>l("td",null,[w(c.value,`${a}/${i}${c.value.type=="Primitive"?"":"/"+c.name}`)])):l("td",null,[w(n,`${a}/${i}`)])]))])]});if(t.type=="Object")return l(N,{"single-line":!1,size:"small"},{default:()=>[l("tr",{"data-pointer":a,onClick:n=>O(n,a)},[l("th",null,[s("Key")]),l("th",null,[s("Value")])]),l("tbody",null,[t.value.map(n=>l("tr",{onClick:i=>O(i,a+`/${n.name}`)},[l("td",null,[n.name]),l("td",null,[w(n.value,`${a}/${n.name}`)])]))])]});if(t.type=="Primitive")return l("span",{onClick:n=>O(n,a)},[t.value.toString()])}}function b(t){if(t){if(t.type=="Array")return l(N,{"single-line":!1,size:"small"},{default:()=>[l("thead",null,[l("tr",null,[l("th",null,[s("Array")])])]),l("tbody",null,[t.value.map(a=>l("tr",null,[l("td",null,[b(a)])]))])]});if(t.type=="sameArrayField")return l(N,{"single-line":!1,size:"small"},{default:()=>[l("thead",null,[l("tr",null,[t.value[0].type==="Object"?t.value[0].value.map(a=>l("th",null,[a.name])):l("th",null,[t.value[0].type])])]),l("tbody",null,[t.value.map(a=>l("tr",null,[a.type==="Object"?a.value.map(n=>l("td",null,[b(n.value)])):l("td",null,[b(a)])]))])]});if(t.type=="Object")return l(N,{"single-line":!1,size:"small"},{default:()=>[l("tr",null,[l("th",null,[s("Key")]),l("th",null,[s("Value")])]),l("tbody",null,[t.value.map(a=>l("tr",null,[l("td",null,[a.name]),l("td",null,[b(a.value)])]))])]});if(t.type=="Primitive")return oe("span",t.value.toString())}}function z(t){if(t===null)return{type:"Primitive",value:"null"};if(Array.isArray(t))return{type:X(t)?"sameArrayField":"Array",value:t.map(a=>z(a))};if(typeof t=="object")return{type:"Object",value:Object.entries(t).map(([a,n])=>({name:a,value:z(n)}))};if(Z(t))return{type:"Primitive",value:t}}function X(t){return t.map(a=>Object.keys(a).join("|")).every((a,n,i)=>a===i[0])&&!Array.isArray(t[0])&&t.length>1}function Z(t){return["string","number","bigint","boolean","undefined","symbol","null","object"].includes(typeof t)}T([p,g],async()=>{try{let t;switch(g.value){case"JSON Pointer":t=R.get(f.value||{},p.value);break;case"JSON Path":t=le.query(f.value,p.value);break;default:break}v.value=t,j.value=JSON.stringify(t)}catch(t){j.value=t.toString()}});function V(t,a){try{return R.get(a,t)}catch{return}}function G(){try{return v.value?b(z(v.value)):l("p",null,[s("empty object")])}catch(t){return l("p",null,[t.toString()])}}return(t,a)=>(h(),y(r(S),{vertical:"",style:{width:"100%",overflow:"scroll",gap:"0"}},{default:o(()=>[l(r(S),{justify:"space-between",style:{padding:"4px 6px","flex-grow":"1","border-bottom":"1px solid var(--n-border-color)"}},{default:o(()=>[l(r(S),{justify:"start",style:{"column-gap":"2px","align-items":"center"}},{default:o(()=>[l(r(P),{onClick:a[0]||(a[0]=n=>I(0)),tertiary:u.value[0].close},{default:o(()=>[l(r(A),{size:"24"},{default:o(()=>[e("img",{src:r(he),style:{width:"100%"}},null,8,ye)]),_:1})]),_:1},8,["tertiary"]),l(r(P),{onClick:a[1]||(a[1]=n=>D())},{default:o(()=>[s("Run "),l(r(A),{size:"20",style:{"margin-left":"5px"}},{default:o(()=>[l(r(ve))]),_:1})]),_:1}),l(r(ue),{size:"small",label:"auto",checked:_.value,"onUpdate:checked":a[2]||(a[2]=n=>_.value=n)},null,8,["checked"])]),_:1}),l(r(S),null,{default:o(()=>[l(r(P),{justify:"end",onClick:a[3]||(a[3]=()=>{I(1)}),tertiary:!u.value[1].close},{default:o(()=>[l(r(A),{size:"22"},{default:o(()=>[e("img",{src:r(ge),style:{width:"100%"}},null,8,_e)]),_:1})]),_:1},8,["tertiary"]),l(r(P),{justify:"end",onClick:a[4]||(a[4]=n=>I(3)),tertiary:u.value[3].close},{default:o(()=>[l(r(A),{size:"24"},{default:o(()=>[e("img",{src:r(fe),style:{width:"100%"}},null,8,Se)]),_:1})]),_:1},8,["tertiary"])]),_:1})]),_:1}),l(r(ee),{horizontal:W(),style:{height:"calc(100% - var(--header-height))"}},{default:o(()=>[u.value[0].close?x("",!0):(h(),y(r($),{key:0},{default:o(()=>[l(r(M),{extensions:E,class:"code_text",style:{height:"100%",width:"100%",overflow:"scroll"},modelValue:d.value,"onUpdate:modelValue":a[5]||(a[5]=n=>d.value=n),type:"textarea",placeholder:'JSON Text { "a" : "123" }'},null,8,["modelValue"])]),_:1})),u.value[1].close?x("",!0):(h(),y(r($),{key:1},{default:o(()=>[l(r(M),{extensions:E,modelValue:k.value,"onUpdate:modelValue":a[6]||(a[6]=n=>k.value=n),class:"code_text",style:{height:"100%",width:"100%",overflow:"scroll"},type:"textarea"},null,8,["modelValue"])]),_:1})),l(r($),{class:"json_table"},{default:o(()=>[(h(),y(L(()=>Q(U.value))))]),_:1}),u.value[3].close?x("",!0):(h(),y(r($),{key:2,style:{"align-items":"flex-start"}},{default:o(()=>[l(r(S),{vertical:"",style:{height:"100%",width:"100%",overflow:"scroll"}},{default:o(()=>{var n;return[e("div",Ne,[l(r(S),{style:{"flex-direction":"row"}},{default:o(()=>[l(r(ce),{value:g.value,"onUpdate:value":a[7]||(a[7]=i=>g.value=i),style:re({width:`calc(${Math.max(...C.map(i=>i.label.length))/1.3}rem)`}),options:C},null,8,["value","style"]),l(r(de),{style:{"margin-bottom":"15px",width:"max-content","flex-grow":"1"},value:p.value,"onUpdate:value":a[8]||(a[8]=i=>p.value=i),"input-props":{autocomplete:"disabled"},options:K(),placeholder:"JSON Pointer e.g. /foo/bar/0",clearable:""},null,8,["value","options"])]),_:1}),l(r(pe),null,{default:o(()=>[g.value=="JSON Pointer"?(h(),y(r(F),{key:0,title:"What's JSON Pointer?",name:"1"},{default:o(()=>[l(r(B),{title:"Example"},{default:o(()=>[je,we,be,xe,ke,Oe]),_:1})]),_:1})):g.value=="JSON Path"?(h(),y(r(F),{key:1,title:"JSONPath - XPath for JSON",name:"1"},{default:o(()=>[l(r(B),{title:"Example"},{default:o(()=>[ze,$e,Je,Pe]),_:1})]),_:1})):x("",!0)]),_:1}),(h(),y(L(()=>G()),{style:{margin:"1rem auto",display:"block"}})),((n=j.value)==null?void 0:n.length)>0?(h(),ie("div",Ae,[Ue,l(r(me),{class:"code_text",value:j.value,"onUpdate:value":a[9]||(a[9]=i=>j.value=i),type:"textarea"},null,8,["value"])])):x("",!0)])]}),_:1})]),_:1}))]),_:1},8,["horizontal"])]),_:1}))}});export{ul as default};
